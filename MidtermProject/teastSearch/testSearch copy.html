<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search a List</title>
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
        }

        ul {
            list-style: none;
        }

        li {
            padding: 10px 0;
            line-height: 1.2rem;
        }
    </style>
</head>

<body>
    <form id="search-videos">
        <label for="search">Search:</label>
        <input type="text" name="search" id="search">
        <button name="search_btn">Search</button>
        <button name="reset" type="reset">Reset</button>
    </form>
    <div id="app"></div>
</body>
<script>


    fetch('./06_1_43_Catalog_of_Products.json')
        .then(function (response) {
            return response.json();
        })
        .then(function (data) {
            appendData(data);
        })
        .catch(function (err) {
            console.log('error:' + err);
        })
    function appendData(data) {
        let mainContainer = document.getElementById("myData");
        for (let productName in data) {
            let div = document.createElement("div");
            div.innerHTML = `<br> <br> <h2> ${productName} </h2>`;
            mainContainer.appendChild(div);
        } // end of for
    } // end of function appendData

    var render = function (data) {
        var app = document.getElementById('app');
        var videosHTMLString = '<ul>' +
            data.map(function (video) {
                return '<li>' +
                    '<strong>Title: </strong>' + video.title + '<br/>' +
                    '<strong>Author: </strong>' + video.creator + '<br/>' +
                    '<strong>Category: </strong>' + video.category + '<br/>' +
                    '<strong>Release Date: </strong>' + video.release + '<br/>' +
                    '</li>';
            }).join('');
        + '</ul>';
        videosHTMLString = "<ul><li><strong>Title: </strong>Cute Cat Video<br/><strong>Author: </strong>TestUser1<br/><strong>Category: </strong>kids<br/><strong>Release Date: </strong>02/13/2023<br/></li><li><strong>Title: </strong>Cute Dog Video<br/><strong>Author: </strong>TestUser2<br/><strong>Category: </strong>kids<br/><strong>Release Date: </strong>02/28/2023<br/></li><li><strong>Title: </strong>Programming Tutorial<br/><strong>Author: </strong>TestUser2<br/><strong>Category: </strong>educational<br/><strong>Release Date: </strong>03/1/2023<br/></li>"

        app.innerHTML = videosHTMLString;
    }
    render(videos);

    var handleSearch = function (event) {
        event.preventDefault();
        // Get the search terms from the input field
        var searchTerm = event.target.elements['search'].value;
        // Tokenize the search terms and remove empty spaces
        var tokens = searchTerm
            .toLowerCase()
            .split(' ')
            .filter(function (token) {
                return token.trim() !== '';
            });
        if (tokens.length) {
            //  Create a regular expression of all the search terms
            var searchTermRegex = new RegExp(tokens.join('|'), 'gim');
            var filteredList = books.filter(function (book) {
                // Create a string of all object values
                var bookString = '';
                for (var key in book) {
                    if (book.hasOwnProperty(key) && book[key] !== '') {
                        bookString += book[key].toString().toLowerCase().trim() + ' ';
                    }
                }
                // Return book objects where a match with the search regex if found
                return bookString.match(searchTermRegex);
            });
            // Render the search results
            render(filteredList);
        }
    };

    document.addEventListener('submit', handleSearch);
    document.addEventListener('reset', function (event) {
        event.preventDefault();
        render(books);
    })
</script>

</html>